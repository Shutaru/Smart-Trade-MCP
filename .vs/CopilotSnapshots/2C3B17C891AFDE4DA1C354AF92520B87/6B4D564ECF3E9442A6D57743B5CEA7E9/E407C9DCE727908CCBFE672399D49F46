# -*- coding: utf-8 -*-
"""Auto-register all 38 generated strategies"""

from ...core.logger import logger


def register_all_generated_strategies(registry_instance):
    """Register all 38 generated strategies automatically."""
    
    # Define all 38 strategies with their metadata
    strategies_to_register = [
        # Mean Reversion (5)
        ("bollinger_mean_reversion", "BollingerMeanReversion", "mean_reversion", "BB mean reversion 60-70% win rate"),
        ("rsi_band_reversion", "RsiBandReversion", "mean_reversion", "RSI + BB reversion 58-68% win rate"),
        ("cci_extreme_snapback", "CciExtremeSnapback", "mean_reversion", "CCI extreme reversal"),
        ("mfi_divergence_reversion", "MfiDivergenceReversion", "mean_reversion", "MFI divergence 52-62% win rate"),
        ("stoch_signal_reversal", "StochSignalReversal", "mean_reversion", "Stochastic crossover reversal"),
        
        # Trend Following (5)
        ("ema_cloud_trend", "EmaCloudTrend", "trend_following", "EMA cloud pullback 50-60% win rate"),
        ("donchian_continuation", "DonchianContinuation", "trend_following", "Donchian breakout continuation"),
        ("macd_zero_trend", "MacdZeroTrend", "trend_following", "MACD zero line trend"),
        ("adx_trend_filter_plus", "AdxTrendFilterPlus", "trend_following", "ADX trend filter 48-58% win rate"),
        ("trendflow_supertrend", "TrendflowSupertrend", "trend_following", "SuperTrend + ADX momentum"),
        
        # Breakout (8)
        ("bollinger_squeeze_breakout", "BollingerSqueezeBreakout", "breakout", "BB squeeze expansion"),
        ("keltner_expansion", "KeltnerExpansion", "breakout", "Keltner channel expansion"),
        ("donchian_volatility_breakout", "DonchianVolatilityBreakout", "breakout", "Donchian with volatility"),
        ("atr_expansion_breakout", "AtrExpansionBreakout", "breakout", "ATR expansion breakout"),
        ("channel_squeeze_plus", "ChannelSqueezePlus", "breakout", "Multi-channel squeeze"),
        ("volatility_weighted_breakout", "VolatilityWeightedBreakout", "breakout", "Volatility weighted breakout"),
        ("london_breakout_atr", "LondonBreakoutAtr", "breakout", "London session breakout"),
        ("vwap_breakout", "VwapBreakout", "breakout", "VWAP breakout"),
        
        # Momentum (8)
        ("ema_stack_momentum", "EmaStackMomentum", "momentum", "EMA stack alignment"),
        ("mfi_impulse_momentum", "MfiImpulseMomentum", "momentum", "MFI impulse momentum"),
        ("triple_momentum_confluence", "TripleMomentumConfluence", "momentum", "Triple oscillator confluence"),
        ("rsi_supertrend_flip", "RsiSupertrendFlip", "momentum", "RSI + SuperTrend flip"),
        ("multi_oscillator_confluence", "MultiOscillatorConfluence", "momentum", "Multi oscillator alignment"),
        ("obv_trend_confirmation", "ObvTrendConfirmation", "momentum", "OBV trend confirmation"),
        ("trend_volume_combo", "TrendVolumeCombo", "momentum", "Trend + volume combination"),
        ("ema_stack_regime_flip", "EmaStackRegimeFlip", "momentum", "EMA stack regime change"),
        
        # Hybrid (6)
        ("vwap_institutional_trend", "VwapInstitutionalTrend", "hybrid", "VWAP institutional 58-68% win rate"),
        ("vwap_mean_reversion", "VwapMeanReversion", "hybrid", "VWAP mean reversion"),
        ("vwap_band_fade_pro", "VwapBandFadePro", "hybrid", "VWAP band fade"),
        ("order_flow_momentum_vwap", "OrderFlowMomentumVwap", "hybrid", "Order flow + VWAP"),
        ("keltner_pullback_continuation", "KeltnerPullbackContinuation", "hybrid", "Keltner pullback"),
        ("ema200_tap_reversion", "Ema200TapReversion", "hybrid", "EMA200 tap reversion 56-64%"),
        
        # Advanced (6)
        ("double_donchian_pullback", "DoubleDonchianPullback", "advanced", "Double Donchian pullback"),
        ("pure_price_action_donchian", "PurePriceActionDonchian", "advanced", "Pure price action"),
        ("obv_confirmation_breakout_plus", "ObvConfirmationBreakoutPlus", "advanced", "OBV breakout confirmation"),
        ("ny_session_fade", "NySessionFade", "advanced", "NY session fade"),
        ("regime_adaptive_core", "RegimeAdaptiveCore", "advanced", "Regime adaptive 52-66%"),
        ("complete_system_5x", "CompleteSystem5x", "advanced", "Complete system 56-68%"),
    ]
    
    registered = 0
    for strategy_name, class_name, category, description in strategies_to_register:
        try:
            # Dynamic import
            module = __import__(f"src.strategies.generated.{strategy_name}", fromlist=[class_name])
            strategy_class = getattr(module, class_name)
            
            # Register
            registry_instance.register(
                name=strategy_name,
                strategy_class=strategy_class,
                category=category,
                description=description,
                default_params={},
            )
            registered += 1
            
        except (ImportError, AttributeError) as e:
            logger.warning(f"Could not register {strategy_name}: {e}")
    
    logger.info(f"Auto-registered {registered}/38 generated strategies")
